accion 2.2.19 es
    AMBIENTE
        fecha = REGISTRO
            año: N(4)
            mes: 1..12
            dia: 1..31
        FIN_REGISTRO

        remedios = REGISTRO
            clave = REGISTRO
                farmacia: N(2)
                Med: N(2)
            FIN_REGISTRO
            cant_act: N(2)
            fecha_venc: fecha
        FIN_REGISTRO

        Mae, MaeAct: Archivo de remedios ordenado por clave
        regMae, regMaeAct: remedios

        movs = REGISTRO
            claveMov = REGISTRO
                farmacia: N(2)
                med: N(2)
            FIN_REGISTRO
            cod_mov: 1..3
            cant_recibida: N(2)
        FIN_REGISTRO
        Mov: archivo de movimiento ordenado por clave y cod_mov
        regMov: movs

        vencidos = REGISTRO
            Medicamento: N(2)
            cant_vencida: N(2)
        FIN_REGISTRO
        Venc: Archivo de vencidos ordenado por Medicamento
        RegVenc: vencidos

        PROCEDIMIENTO LEER_Mae() ES
            LEER(Mae, regMae)
            SI FDA(Mae) ENTONCES
                regMae.clave:= HV
            FIN_SI
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO LEER_Mov() ES
            LEER(Mov, regMov)
            SI FDA(Mov) ENTONCES
                regMov.claveMov:= HV
            FIN_SI
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO procesos_iguales() ES
            SEGUN regMae.cod_mov HACER
                1:
                    ESC("Error, no se admite un alta")
                2:
                    RegVenc.Medicamento:= regMov.claveMov.med
                    RegVenc.cant_vencida:= regMov.cant_recibida
                    ESC(Venc, RegVenc)
                3:
                    regMaeAct := regMae
                    regMaeAct.cant_actual:= regMae.cant_actual + regMov.cant_recibida
                    ESC(MaeAct, regMaeAct)
            FIN_SEGÚN
            LEER_mov()
            LEER_mae()

            PROCEDIMIENTOS procesos_distintos() ES
                SEGUN regMov.cod_mov HACER
                    1:
            FIN_PROCEDIMIENTO

    PROCESO
        ABRIR E/(Mae); ABRIR E/(Mov)
        ABRIR /S(MaeAct); ABRIR /S(Venc)

        LEER_Mae()
        LEER_Mov()
        MIENTRAS (regMae.clave <> HV) o (regMov.claveMov <> HV) HACER
            SI regMae.clave < regMov.clave ENTONCES
                regMaeAct:= regMae
                ESC(MaeAct, regMaeAct)
                LEER_Mae()
            SINO
                SI regMae.clave = regMov.clave ENTONCES
                    procesos_iguales()
                SINO
                    procesos_distintos()
                FIN_SI
            FIN_SI
        FIN_MIENTRAS


